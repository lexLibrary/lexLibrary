<!DOCTYPE html>
<html lang="en">

<head>
	[[template "header"]]
	<title>Administration - Lex Library</title>
</head>

<body>
	[[template "nav" .]]
	<div class="container grid-xl">
		<h1>Administration</h1>
		<ul class="tab tab-block">
			<li class='tab-item [[if eq .Tab "overview"]]active[[end]]'><a href="/admin">Overview</a></li>
			<li class='tab-item [[if eq .Tab "settings"]]active[[end]]'><a href="/admin/settings">Settings</a></li>
			<li class='tab-item [[if eq .Tab "logs"]]active[[end]]'><a href="/admin/logs">Logs</a></li>
			<li class='tab-item [[if eq .Tab "registration"]]active[[end]]'><a href="/admin/registration">Registration</a></li>
		</ul>
		<div id="admin">
			[[if eq .Tab "overview"]]
				[[template "overview" .]]
			[[else if eq .Tab "settings"]]
				[[template "settings" .]]
			[[else if eq .Tab "logs"]]
				[[template "logs" .]]
			[[else if eq .Tab "registration"]]
				[[template "registration" .]]
			[[end]]
		</div>
	</div>
</body>
<script src="/js/vue.js"></script>
<script src="/js/admin.js"></script>
</html>


[[define "overview"]]
<section class="pt-2">
	<div class="columns">
		<div class="column text-center">
			<h5 class="title"><small>Users</small></h5>
			<h3>[[.Overview.Instance.Users]]</h3>
		</div>
		<div class="column text-center">
			<h5 class="title"><small>Logged In</small></h5>
			<h3>[[.Overview.Instance.Sessions]]</h3>
		</div>
		<div class="column text-center">
			<h5 class="title"><small>Documents</small></h5>
			<h3>[[.Overview.Instance.Documents]]</h3>
		</div>
	</div>
</section>
<section class="pt-4">
	<div class="card-columns col-lg">
		
		<div class="card">
			<div class="card-header">
				<div class="card-title h5">Instance Information</div>
			</div>
			<div class="card-body">
				[[with .Overview.Instance]]
				<table class="overview table">
					<tbody>
						<tr><td>Version</td><td>[[.Version]]</td></tr>
						<tr><td>Build Date</td><td title="[[time .BuildDate]]">[[time .BuildDate]]</td></tr>
						<tr><td>Uptime</td><td>[[duration .Uptime]]</td></tr>
						<tr><td>First Launch</td><td title="[[time .FirstLaunch]]">[[since .FirstLaunch]]</td></tr>
						<tr><td>Errors Since Last Start</td><td>[[.ErrorsSinceStart]]</td></tr>
						<tr><td>Total Number of Errors</td><td>[[.ErrorsTotal]]</td></tr>
					</tbody>
				</table>
				[[end]]
			</div>
		</div> <!-- card -->
		<div class="card">
			<div class="card-header">
				<div class="card-title h5">Data Usage</div>
				[[if eq .Overview.Config.DatabaseType "sqlite"]]
					<div class="card-subtitle text-gray">Image Size is not available on SQLITE</div>
				[[else if eq .Overview.Config.DatabaseType "cockroachdb"]]
					<div class="card-subtitle text-gray">Data Sizes are not currently availble on Cockroach DB</div>
				[[end]]
			</div>
			<div class="card-body">
				<table class="overview table">
					<tbody>
						[[with .Overview.Instance.Size]]
						<tr><td>Database Size</td><td>[[bytes .Data]]</td></tr>
						<tr><td>Image Size</td><td>[[bytes .Image]]</td></tr>
						<tr><td>Search Index Size</td><td>[[bytes .Search]]</td></tr>
						<tr><td>Total Size</td><td>[[bytes .Total]]</td></tr>
						[[end]]
						<tr><td>Space Available</td><td>[[bytes .Overview.System.FreeSpace]]</td></tr>
					</tbody>
				</table>
			</div>
		</div> <!-- card -->
		<div class="card">
			<div class="card-header">
				<div class="card-title h5">System Information</div>
			</div>
			<div class="card-body">
				[[with .Overview.System]]
				<table class="overview table">
					<tbody>
						<tr><td>Uptime</td><td>[[duration .Uptime]]</td></tr>
						<tr><td>Total RAM</td><td>[[bytes .Totalram]]</td></tr>
						<tr><td>Free RAM</td><td>[[bytes .Freeram]]</td></tr>
						<tr><td>Shared RAM</td><td>[[bytes .Sharedram]]</td></tr>
						<tr><td>Total Swap</td><td>[[bytes .Totalswap]]</td></tr>
						<tr><td>Free Swap</td><td>[[bytes .Freeswap]]</td></tr>
						<tr><td>Free Space</td><td>[[bytes .FreeSpace]]</td></tr>
						<tr><td>Total Space</td><td>[[bytes .TotalSpace]]</td></tr>
					</tbody>
				</table>
				[[end]]
			</div>
		</div> <!-- card -->

		<div class="card">
			<div class="card-header">
				<div class="card-title h5">Runtime</div>
			</div>
			<div class="card-body">
				[[with .Overview.Runtime]]
				<table class="overview table">
					<tbody>
						<tr><td>OS</td><td>[[.OS]]</td></tr>
						<tr><td>Go Version</td><td>[[.GoVer]]</td></tr>
						<tr><td>Architecture</td><td>[[.Arch]]</td></tr>
						<tr><td>Compiler</td><td>[[.Compiler]]</td></tr>
						<tr><td>Max Procs</td><td>[[.MaxProcs]]</td></tr>
						<tr><td>Number of CPUs</td><td>[[.NumCPU]]</td></tr>
					</tbody>
				</table>
				[[end]]
			</div>
		</div> <!-- card -->
		<div class="card">
			<div class="card-header">
				<div class="card-title h5">Web Configuration</div>
				<div class="card-subtitle text-gray">Values are set by configuration or environment variable.</div>
			</div>
			<div class="card-body">
				<table class="overview table">
					<tbody>
						[[with .WebConfig]]
						<tr><td>Read Timeout</td><td>[[.ReadTimeout]]</td></tr>
						<tr><td>Write Timeout</td><td>[[.WriteTimeout]]</td></tr>
						<tr><td>Max Header Bytes</td><td>[[.MaxHeaderBytes]]</td></tr>
						<tr><td>Min TLS Version</td><td>[[.MinTLSVersion]]</td></tr>
						<tr><td>Certificate File</td><td title="[[.CertFile]]">[[.CertFile]]</td></tr>
						<tr><td>Key File</td><td title="[[.KeyFile]]">[[.KeyFile]]</td></tr>
						<tr><td>Max Upload Memory (MB)</td><td>[[.MaxUploadMemoryMB]]</td></tr>
						<tr><td>Port</td><td>[[.Port]]</td></tr>
						[[end]]
					</tbody>
				</table>
			</div>
		</div> <!-- card -->
		<div class="card">
			<div class="card-header">
				<div class="card-title h5">Data Configuration</div>
				<div class="card-subtitle text-gray">Values are set by configuration or environment variable.</div>
			</div>
			<div class="card-body">
				<table class="overview table">
					<tbody>
						[[with .Overview.Config]]
						[[if eq .DatabaseType "sqlite"]]
						<tr><td>Data File</td><td title="[[.DatabaseFile]]">[[.DatabaseFile]]</td></tr>
						[[end]]
						<tr><td>Search File</td><td title="[[.SearchFile]]">[[.SearchFile]]</td></tr>
						<tr><td>Database Type</td><td>[[.DatabaseType]]</td></tr>
						<tr><td>SSL Cert</td><td title="[[.SSLCert]]">[[.SSLCert]]</td></tr>
						<tr><td>SSL Key</td><td title="[[.SSLKey]]">[[.SSLKey]]</td></tr>
						<tr><td>SSL Root Cert</td><td title="[[.SSLRootCert]]">[[.SSLRootCert]]</td></tr>
						<tr><td>Max Idle Connections</td><td>[[.MaxIdleConnections]]</td></tr>
						<tr><td>Max Open Connections</td><td>[[.MaxOpenConnections]]</td></tr>
						<tr><td>Max Connection Lifetime</td><td>[[.MaxConnectionLifetime]]</td></tr>
						[[end]]
					</tbody>
				</table>
			</div>
		</div> <!-- card -->


	</div> <!-- card-columns -->
</section>
[[end]]


[[define "settings"]]
<section class="section settings">
	<div class="container">
		<div class="columns">
			<div class="column">
				<div class="card">
					<div class="card-header">
						<div class="card-title h5">Security and Authentication</div>
					</div>
					<div class="card-body">
						<form class="form-horizontal">
							<div class="form-group">
								<div class="col-3 col-sm-12">
									<label class="form-label" for="input-example-1">Name</label>
								</div>
								<div class="col-9 col-sm-12">
									<input class="form-input" type="text" id="input-example-1" placeholder="Name">
								</div>
							</div>
							<!-- form structure -->
						</form>
					</div>
				</div> <!-- card -->
			</div> <!-- column -->
			<div class="column">
				<div class="card">
					<div class="card-header">
						<div class="card-title h5">Documents</div>
					</div>
					<div class="card-body">
					</div>
				</div> <!-- card -->
			</div> <!-- column -->
		</div> <!-- columns -->
		<div class="columns">
			<div class="column">
				<div class="card">
					<div class="card-header">
						<div class="card-title h5">Web Server</div>
					</div>
					<div class="card-body">
					</div>
				</div> <!-- card -->
			</div> <!-- column -->
			<div class="column">
				<div class="card">
					<div class="card-header">
						<div class="card-title h5">Misc</div>
					</div>
					<div class="card-body">
					</div>
				</div> <!-- card -->
			</div> <!-- column -->
		</div> <!-- columns -->
	</div> <!-- container -->
</section>
[[end]]


[[define "logs"]]
	[[with .Log]]
	<section class="logs section">
		[[if .Entry]]
			[[with .Entry]]
				<h4>Log Entry from [[time .Occurred]] <small class="text-gray">([[.ID]])</small></h4>
				<hr>
				<p>[[.Message]]</p>
			[[end]]
		[[else]]
			<div class="columns">
				<div class="col-sm-12 col-5 centered">
					<form id="logSearch" @submit="search">
						<div class="input-group">
							<input v-model="searchValue" type="text" class="form-input input" placeholder="Search Logs">
							<button type="submit" class="btn btn-primary input-group-btn">Search</button>
						</div>
					</form>
				</div>
			</div>
			<table class="table">
				<thead>
					<tr>
						<th class="date">Date</th>
						<th>Error</th>
						<th class="view-link"></th>
					</tr>
				</thead>
				<tbody>
					[[range .Logs]]
						<tr>
							<td>[[time .Occurred]]</td>
							<td title="[[.Message]]">[[.Message]]</td>
							<td><a class="float-right" href="/admin/logs/[[.ID]]">View</a></td>
						</tr>
					[[end]]
				</tbody>
			</table>
			[[template "pager" .Pager]]
		[[end]]
	</section>
	[[end]]
[[end]]
[[define "registration"]]
<p>Registration</p>
[[end]]
