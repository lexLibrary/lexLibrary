<!DOCTYPE html>
<html lang="en">

<head>
	[[template "header"]]
	<title>Edit Profile - Lex Library</title>
</head>

<body>
<section class="section">

<div class="container grid-md">
	<div class="columns">
			<div class="column">
				<div class="card">
					<div class="card-content">
						<div class="columns">
							<div class="column">
								<section class="section">
									<h1>Update Profile</h1>
									<form @sumbit="changeName">
										<div :class="{'has-error': nameErr}" class="form-group">
											<label class="form-label" for="inputName">Name</label>
											<input v-model="user.name" type="text" class="form-input" id="inputName" placeholder="Enter a name">
											<p v-if="nameErr" v-cloak class="form-input-hint">{{nameErr}}</p>
										</div>
										<div class="form-group">
											<button type="submit" :class="{'loading': loading}" class="btn btn-primary" @click="changeName">
												Update
											</button>
										</div>
									</form>
								</section>
							</div> <!-- column -->
							<div class="column text-center">
								<section class="section">
									<figure class="avatar avatar-full" data-initial="[[.DisplayInitials]]">
										[[if .ProfileImage]]
											<img src="/profile/image" alt="[[.DisplayName]]">
										[[end]]
									</figure>
									<file-input accept="image/jpeg,image/gif,image/png" @change="uploadImage">
										<button class="mt-2 btn">Select an Image</button>
									</file-input>
								</section>
							</div> <!-- column -->
					</div>
				</div>
			</div>
	</div>
</div>

<div :class="{'active': imageModal}" class="modal">
	<div @click="imageModal=false" class="modal-overlay"></div>
	<div class="modal-container">
		<header class="modal-header">
			<a @click="imageModal=false" class="btn btn-clear float-right" aria-label="Close"></a>
      <div class="modal-title h5">Set Profile Image</div>
    </header>
		<section class="modal-body">
			<div class="content text-center">
				<div v-if="uploadErr" class="toast toast-error">
					<button @click="uploadErr=null"class="btn btn-clear float-right"></button>
					{{uploadErr}}
				</div>
				<img v-if="uploadComplete" @load="loadCrop" src="/profile/image" class="profile-img-upload img-responsive" alt="[[.DisplayName]]">
				<div v-if="!uploadComplete" class="bar">
					<div class="bar-item" role="progressbar" :style="{width: imageProgress+'%'}" 
						:aria-valuenow="imageProgress" aria-valuemin="0" aria-valuemax="100">
						{{imageProgress}}%
					</div>
				</div>
			</div>
		</section>
		<footer v-if="uploadComplete" class="modal-footer">
			<button @click="setImage" type="button" :class="{'loading': imageLoading}" class="btn btn-primary">Set Image</button>
		</footer>
	</div>
</div> <!-- modal -->


</section>
</body>
<script type="application/json" id="payload">[[.]]</script>
<script type="application/json" id="csrf">[[.CSRFToken]]</script>
<script src="/js/vue.js"></script>
<script src="/js/profile_edit.js"></script>
</html>
