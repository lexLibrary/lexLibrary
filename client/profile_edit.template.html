<!DOCTYPE html>
<html lang="en">

<head>
	[[template "header"]]
	<title>Edit Profile - Lex Library</title>
</head>

<body>
<section class="section">

<div class="container grid-lg">
	<div class="columns">
		<div class="column col-3">
			<ul class="menu">
				<!-- menu header text -->
				<li class="menu-item">
					<div>
						<h4>Settings</h4>
					</div>
				</li>
				<li class="divider">
				</li>
				<li class="menu-item">
					<a class='[[if eq .Tab "profile"]]active[[end]]' href="/profile/edit/">
						Profile
					</a>
				</li>
				<li class="menu-item">
					<a class='[[if eq .Tab "account"]]active[[end]]' href="/profile/edit/account">
						Account
					</a>
				</li>
				<!-- <li class="menu-item text-right"> -->
				<!-- 	<a href="/profile/"> -->
				<!-- 		<small><i class="icon icon-back"></i> Back</small> -->
				<!-- 	</a> -->
				<!-- </li> -->
			</ul>
		</div>
		<div class="column">
			<div class="card">
				<div class="card-content">
					<div class="columns">
						<div class="column">
							<section class="section">
								<h2>Update Profile</h2>
								<form @sumbit="changeName">
									<div :class="{'has-error': nameErr}" class="form-group">
										<label class="form-label" for="inputName">Name</label>
										<input v-model="user.name" type="text" class="form-input" id="inputName" placeholder="Enter a name">
										<p v-if="nameErr" v-cloak class="form-input-hint">{{nameErr}}</p>
									</div>
									<div class="form-group">
										<button type="submit" :class="{'loading': loading}" class="btn btn-primary" @click="changeName">
											Update
										</button>
									</div>
								</form>
							</section>
						</div> <!-- column -->
						<div class="column text-center">
							<section class="section">
								<figure class="avatar avatar-full" data-initial="[[.User.DisplayInitials]]">
									[[if .User.ProfileImage]]
										<img src="/profile/image" alt="[[.User.DisplayName]]">
									[[end]]
								</figure>
								<file-input accept="image/jpeg,image/gif,image/png" @change="uploadImage">
									<button class="mt-2 btn">Select an Image</button>
								</file-input>
							</section>
						</div> <!-- column -->
					</div>
				</div>
			</div>
	</div>
</div>

<div :class="{'active': imageModal}" class="modal">
	<div @click="closeImageModal" class="modal-overlay"></div>
	<div class="modal-container">
		<header class="modal-header">
			<a @click="closeImageModal" class="btn btn-clear float-right" aria-label="Close"></a>
      <div class="modal-title h5">Set Profile Image</div>
    </header>
		<section class="modal-body">
			<div class="content text-center">
				<div v-if="uploadErr" class="toast toast-error">
					<button @click="uploadErr=null"class="btn btn-clear float-right"></button>
					{{uploadErr}}
				</div>
				<div v-if="uploadComplete">
					<img @load="loadCrop" :src="draftImage" class="profile-img-upload img-responsive" alt="[[.User.DisplayName]]">
				</div>
				<div v-if="!uploadComplete" class="bar">
					<div class="bar-item" role="progressbar" :style="{width: imageProgress+'%'}" 
						:aria-valuenow="imageProgress" aria-valuemin="0" aria-valuemax="100">
						{{imageProgress}}%
					</div>
				</div>
			</div>
		</section>
		<footer v-if="uploadComplete" class="modal-footer">
			<button @click="setImage" type="button" :class="{'loading': imageLoading}" class="btn btn-primary">Set Image</button>
		</footer>
	</div>
</div> <!-- modal -->


</section>
</body>
<script type="application/json" id="payload">[[.User]]</script>
<script src="/js/vue.js"></script>
<script src="/js/profile_edit.js"></script>
</html>
